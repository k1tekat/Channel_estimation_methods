# Методы оценки канала

*В работе проводится сравнительный анализ двух методов оценки канала связи, включая метод наименьших квадратов и метод, основанный на среднеквадратичном отклонении. Модуль оценки канала играет ключевую роль в обеспечении точности демодуляции принятых сигналов. Поскольку стандарты связи не регламентируют его реализацию, разработка эффективных алгоритмов оценки канала остается задачей производителей телекоммуникационного оборудования.*
## Описание Модели
Для выполнения сравнения двух методов оценки канала, необходим OFDM (Orthogonal frequency-division multiplexing) приемник и передатчик. Реализовано моделирование OFDM передатчика и приемника с использованием квадратурно амплитудной модуляцией QAM-16 (Quadrature amplitude modulation). Блок схема передатчика и приемника в системе OFDM:

![alt text](https://sun9-12.userapi.com/impg/XrQuYLaJD4HoWnzPpZWluVNw8H2QWLdUeqmmiA/_z5UL4C_i74.jpg?size=1280x795&quality=95&sign=7c894fbd6b4821cd91bb036778ef813a&type=album)







Для оценки канала можно использовать обучающие символы, которые обычно обеспечивают хорошую производительность. 
Однако эффективность их передачи снижается из-за дополнительных затрат на обучающие символы, такие как преамбула или пилотные тона, которые передаются в дополнение к символам данных.  Для оценки канала при наличии обучающих символов широко используются методы наименьших квадратов (LS) и минимальной среднеквадратичной ошибки (MMSE). 
Мы предполагаем, что все поднесущие являются ортогональными (т. е. не содержат межсимвольных интерференций). Тогда обучающие символы для N поднесущих могут быть представлены в виде следующей диагональной матрицы:

Матрица X представляет собой диагональную матрицу размерности N×N, где каждый элемент на диагонали x[k] соответствует пилотному символу k-й поднесущей. Размерность матрицы зависит от количества поднесущих N.

```math
\mathbf{X} =  
 \begin{vmatrix}
 \mathbf{X[0]} & 0 & \mathbf{ \cdots }& 0
 \\0 & X[1] &  & \vdots
 \\\vdots & & \ddots & 0
 \\ 0 & \cdots & 0 & X[N-1]
 \end{vmatrix} 
```

где
```math 
X[k]
```
 точка пилот сигнала k-й поднесущей, с мат. ожиданием:
```math
\mathbb{E}\{X[k]\} = 0
```
и дисперсией:
```math
\mathrm{Var} {X[k] } =  \sigma_x^2 , ( k = 0, 1, 2, \dots, N-1 )
```
Обратите внимание, что X задаётся диагональной матрицей, поскольку мы предполагаем, что все поднесущие являются ортогональными. Учитывая, что коэффициент влияния канала H[k] для каждой поднесущей k, принятый обучающий сигнал Y[k] можно представить в виде
```math
Y \triangleq 
\begin{bmatrix}
Y[0] \\
Y[1] \\
\vdots \\
Y[N-1]
\end{bmatrix} = 
\begin{bmatrix}
X[0] & 0 & \cdots & 0 \\
0 & X[1] & \ddots & \vdots \\
\vdots & \ddots & \ddots & 0 \\
0 & \cdots & 0 & X[N-1]
\end{bmatrix}
\begin{bmatrix}
H[0] \\
H[1] \\
\vdots \\
H[N-1]
\end{bmatrix} + 
\begin{bmatrix}
Z[0] \\
Z[1] \\
\vdots \\
Z[N-1]
\end{bmatrix}
= XH + Z (6.3)

```
где H - вектор канала, заданный в виде 
```math
H = [H[0], H[1], \dots, H[N-1]]^T 
```
а Z - это вектор шума, заданный как
```math
Z = [Z[0], Z[1], \dots, Z[N-1]]^T
```
вместе с мат. ожиданием:
```math
\mathbb{E}\{Z[k]\} = 0
```
и дисперсией:
```math
\mathrm{Var}\{Z[k]\} = \sigma_z^2,( k = 0, 1, 2, \dots, N-1).
```
Получается, что принятый сигнал Y, это произведение значений влияния канала на значения пилотных сигналов + шум.
На основе изветных значений пилот сигналов, можно вычислить не известные значения влияния канала.
В дальнейшем, 
```math
\hat{H}
```
обозначим как оценку канала H.


# Методы оценки канала наименьших квадратов


##
Метод наименьших квадратов (LS) для оценки канала находит оценку канала 
```math
\hat{H}
```
таким образом,чтобы минимизировать следующую функцию стоимости:

```math
\begin{aligned}
J(\hat{H}) &= \|Y - X\hat{H}\|^2 \\
&= (Y - X\hat{H})^H (Y - X\hat{H}) \\
&= Y^H Y - Y^H X \hat{H} - \hat{H}^H X^H Y + \hat{H}^H X^H X \hat{H}
\end{aligned}
```
Приравниваем производную функции к нулю:

$$
\frac{\partial J(\mathbf{\hat{H}})}{\partial \mathbf{\hat{H}}} = -2(\mathbf{X}^H \mathbf{Y})^* + 2(\mathbf{X}^H \mathbf{X} \mathbf{H})^* = 0
$$
и получаем: $$ \mathbf{X}^H \mathbf{X} \hat{\mathbf{H}} = \mathbf{X}^H \mathbf{Y},$$

что даёт решение для оценки канала методом наименьших квадратов в виде:

$$
\hat{\mathbf{H}}_{LS} = (\mathbf{X}^H \mathbf{X})^{-1} \mathbf{X}^H \mathbf{Y} = \mathbf{X}^{-1} \mathbf{Y}
$$

$$\hat{H}_{LS}[k] = \frac{Y[k]}{X[k]}, \quad k = 0, 1, 2, \ldots, N-1$$




















